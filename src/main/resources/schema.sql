CREATE TABLE IF NOT EXISTS USERS
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    NAME VARCHAR(255) NOT NULL,
    EMAIL VARCHAR(512) NOT NULL,
    CONSTRAINT USER_PK PRIMARY KEY (ID),
    CONSTRAINT USER_EMAIL_UQ UNIQUE (EMAIL)
);

CREATE TABLE IF NOT EXISTS REQUESTS
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    DESCRIPTION VARCHAR(512),
    REQUESTER_ID BIGINT NOT NULL,
    CREATED TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    CONSTRAINT REQUEST_PK PRIMARY KEY (ID),
    CONSTRAINT REQUESTER_FK FOREIGN KEY (REQUESTER_ID) REFERENCES USERS
);

CREATE TABLE IF NOT EXISTS ITEMS
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    OWNER_ID BIGINT NOT NULL,
    NAME VARCHAR(255),
    DESCRIPTION VARCHAR(512),
    AVAILABLE BOOLEAN NOT NULL,
    REQUEST_ID BIGINT NOT NULL,
    CONSTRAINT ITEM_ID PRIMARY KEY (ID),
    CONSTRAINT OWNER_ID_FK FOREIGN KEY (OWNER_ID) REFERENCES USERS,
    CONSTRAINT REQUEST_ID_FK FOREIGN KEY (REQUEST_ID) REFERENCES REQUESTS
);

CREATE TABLE IF NOT EXISTS BOOKINGS
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    START TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    END TIMESTAMP WITHOUT TIME ZONE NOT NULL,
    ITEM_ID BIGINT NOT NULL,
    BOOKER_ID BIGINT NOT NULL,
    STATUS varchar(100) NOT NULL,
    CONSTRAINT BOOKING_PK PRIMARY KEY(ID),
    CONSTRAINT ITEM_FK FOREIGN KEY(ITEM_ID) REFERENCES ITEMS,
    CONSTRAINT USER_BOOKER_FK FOREIGN KEY (BOOKER_ID) REFERENCES USERS
);

CREATE TABLE IF NOT EXISTS COMMENTS
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    TEXT VARCHAR(512),
    ITEM_ID BIGINT NOT NULL,
    AUTHOR_ID BIGINT NOT NULL,
    CONSTRAINT COMMENT_PK PRIMARY KEY(ID),
    CONSTRAINT ITEM_COMMENT_FK FOREIGN KEY(ITEM_ID) REFERENCES ITEMS,
    CONSTRAINT AUTHOR_FK FOREIGN KEY(AUTHOR_ID) REFERENCES USERS
);